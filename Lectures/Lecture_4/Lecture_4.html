<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculus - Lecture 4: The Limit of a Function</title>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        body {
            font-family: 'Cambria', 'Georgia', serif;
            font-size: 24px;
            line-height: 1.8;
            color: #333;
            background-color: #fdfdfd;
            overflow-y: scroll;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 25px 40px;
            border: 1px solid #ddd;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            background-color: #fff;
        }
        h1, h2, h3, h4 {
            color: #003366;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            font-weight: 400;
        }
        h1 { font-size: 2.0em; }
        h2 { font-size: 1.6em; margin-top: 1.5em; }
        h3 { font-size: 1.2em; border-bottom: none; }
        h4 { font-size: 1.1em; border-bottom: none; color: #005a9c; }
        p {
            font-size: 1em;
        }
        table {
            width: 85%;
            margin: 30px auto;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 15px;
            text-align: center;
            font-size: 0.9em;
        }
        .remark {
            background-color: #f0f7ff;
            border-left: 5px solid #005a9c;
            padding: 20px;
            margin: 20px 0;
            font-style: italic;
            font-size: 1em;
        }
        .example-box {
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            padding: 25px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .example-box h3, .check-understanding h4 {
            margin-top: 0;
            color: #005a9c;
            font-size: 1.1em;
        }
        .example-box p {
            font-size: 0.95em;
        }
        iframe {
            display: block;
            margin: 30px auto;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        th {
            background-color: #f2f8ff;
            color: #003366;
        }
        em {
            font-style: italic;
            font-weight: normal;
        }
        .hidden-text {
            display: none;
        }
        .controls {
            position: sticky;
            top: 0;
            background-color: #fdfdfd;
            padding: 10px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            z-index: 1000;
            text-align: center;
        }
        .controls button, .controls select {
            padding: 8px 15px;
            margin: 0 5px;
            border: 1px solid #005a9c;
            border-radius: 4px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s ease;
        }
        .controls button:hover, .controls select:hover {
            background-color: #0056b3;
        }
        .controls select {
            background-color: #f2f8ff;
            color: #003366;
        }
        .check-understanding {
            background-color: #fffbe6;
            border: 1px solid #ffe58f;
        }
        .check-understanding .solution {
            border-top: 1px dashed #ddd;
            margin-top: 15px;
            padding-top: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="controls">
            <button id="pausePlayButton">Play</button>
            <select id="speedSelect">
                <option value="1">1x Speed</option>
                <option value="1.5">1.5x Speed</option>
                <option value="2">2x Speed</option>
                <option value="5">5x Speed</option>
            </select>
            <button id="showAllButton">Show All</button>
        </div>

        <div id="lecture-content">
            <h1>Lecture 4: The Limit of a Function</h1>
            <p>Welcome back, everyone. In our last lecture, we saw that the problems of finding a tangent slope and an instantaneous velocity both relied on the same core strategy: approximating a value by looking at what happens as we get closer and closer to a specific point. Today, we give this powerful idea its formal name: the <em>limit</em>.</p>
            <hr>

            <h2>Topic 1: Investigating Limits Numerically and Graphically</h2>
            <p>Let's start with an intuitive definition. We say that the limit of a function $f(x)$ as $x$ approaches a number $a$ is equal to a number $L$ if we can make the values of $f(x)$ as close to $L$ as we like by taking $x$ to be sufficiently close to $a$ (on either side of $a$) but not equal to $a$.</p>
            <p>We write this using the following notation:</p>
            <p>$$\lim_{x \to a} f(x) = L$$</p>
            <p class="remark">The most important part of this definition is that we do not care about the value of the function at $x=a$. The function might be defined at $a$, or it might not. The limit is only concerned with the behavior of the function "near" $a$.</p>
            
            <p>A common scenario is trying to find a limit by "plugging in" the value of $a$. Sometimes this works, but often it gives us the form $\frac{0}{0}$. This is called an <em>indeterminate form</em>. It doesn't mean the limit is 0 or that it doesn't exist. It's a signal that we must do more work, either by investigating numerically with a table of values or by using algebra to simplify the function.</p>

            <div class="example-box">
                <h3>Example 1</h3>
                <p>Use a table of values to estimate the value of $\lim_{x \to 2} \frac{x^2 - 4}{x - 2}$.</p>
                <h4>Solution:</h4>
                <p>First, notice that if we try to substitute $x=2$ into the function, we get:</p>
                <p>$$f(2) = \frac{2^2 - 4}{2 - 2} = \frac{4-4}{2-2} = \frac{0}{0}$$</p>
                <p>This is our indeterminate form, so we must investigate further. Let's create a table of values for $x$ approaching 2 from both sides.</p>
                <table>
                    <tr>
                        <th>$x$ (from the left)</th>
                        <th>$f(x) = \frac{x^2 - 4}{x - 2}$</th>
                        <th>$x$ (from the right)</th>
                        <th>$f(x) = \frac{x^2 - 4}{x - 2}$</th>
                    </tr>
                    <tr><td>1.9</td><td>3.9</td><td>2.1</td><td>4.1</td></tr>
                    <tr><td>1.99</td><td>3.99</td><td>2.01</td><td>4.01</td></tr>
                    <tr><td>1.999</td><td>3.999</td><td>2.001</td><td>4.001</td></tr>
                </table>
                <p>The table shows that as $x$ gets closer to 2, $f(x)$ gets closer to 4. We can also see this by simplifying the function algebraically for $x \neq 2$:</p>
                <p>$$f(x) = \frac{x^2 - 4}{x - 2} = \frac{(x-2)(x+2)}{x-2} = x+2$$</p>
                <p>The graph of our function is the line $y=x+2$ with a hole at $x=2$. The limit is the height of that hole. Therefore, we conclude:</p>
                <p>$$\lim_{x \to 2} \frac{x^2 - 4}{x - 2} = 4$$</p>
                <iframe src="https://www.desmos.com/calculator/x7bagldvrk?embed" width="900" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>
            </div>

            <div class="example-box">
                <h3>Example 2</h3>
                <p>Find the value of $\lim_{x \to 9} \frac{\sqrt{x} - 3}{x-9}$.</p>
                <h4>Solution:</h4>
                <p>Direct substitution of $x=9$ gives $\frac{\sqrt{9}-3}{9-9} = \frac{3-3}{9} = \frac{0}{0}$. This is an indeterminate form. A table of values would work, but here we can use algebra. The key is to multiply the numerator and denominator by the <em>conjugate</em> of the numerator, which is $\sqrt{x}+3$.</p>
                <p>$$\lim_{x \to 9} \frac{\sqrt{x} - 3}{x-9} = \lim_{x \to 9} \left( \frac{\sqrt{x} - 3}{x-9} \right) \cdot \left( \frac{\sqrt{x} + 3}{\sqrt{x} + 3} \right)$$</p>
                <p>Now, let's expand the numerator. Remember that $(a-b)(a+b) = a^2 - b^2$.</p>
                <p>$$(\sqrt{x}-3)(\sqrt{x}+3) = (\sqrt{x})^2 - (3)^2 = x - 9$$</p>
                <p>Substituting this back into our limit expression:</p>
                <p>$$\lim_{x \to 9} \frac{x-9}{(x-9)(\sqrt{x}+3)}$$</p>
                <p>Since $x$ is only approaching 9, $x \neq 9$, so $x-9 \neq 0$. This means we can cancel the $(x-9)$ terms.</p>
                <p>$$\lim_{x \to 9} \frac{1}{\sqrt{x}+3}$$</p>
                <p>Now we can use direct substitution:</p>
                <p>$$\frac{1}{\sqrt{9}+3} = \frac{1}{3+3} = \frac{1}{6}$$</p>
                <iframe src="https://www.desmos.com/calculator/5mix3w4tt8?embed" width="900" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>
            </div>

            <div class="example-box check-understanding">
                <h4>Check Your Understanding: Pause the playback</h4>
                <p>Problem: Use a table of values to estimate $\lim_{x \to 0} \frac{e^{2x} - 1}{x}$.</p>
                <div class="solution" style="display: none;">
                    <p>Solution:</p>
                    <p>Direct substitution gives $\frac{e^{2(0)}-1}{0} = \frac{e^0-1}{0} = \frac{1-1}{0} = \frac{0}{0}$. This is another indeterminate form. Since we don't have an easy algebraic trick for this one yet, we must use a table.</p>
                     <table>
                        <tr>
                            <th>$x$</th>
                            <th>$f(x) = \frac{e^{2x} - 1}{x}$</th>
                        </tr>
                        <tr><td>-0.1</td><td>1.8127</td></tr>
                        <tr><td>-0.01</td><td>1.9801</td></tr>
                        <tr><td>-0.001</td><td>1.9980</td></tr>
                        <tr><td>0.001</td><td>2.0020</td></tr>
                        <tr><td>0.01</td><td>2.0201</td></tr>
                        <tr><td>0.1</td><td>2.2140</td></tr>
                    </table>
                    <p>The numerical evidence suggests that the values of $f(x)$ are approaching 2 as $x$ approaches 0. Our estimate is:</p>
                    <p>$$\lim_{x \to 0} \frac{e^{2x} - 1}{x} = 2$$</p>
                    <iframe src="https://www.desmos.com/calculator/ivb8fzglio?embed" width="900" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>
                </div>
            </div>
            <hr>
            
            <h2>Topic 2: One-Sided Limits</h2>
            <p>Sometimes a function behaves differently depending on whether we approach a point from the left or the right. This requires a more precise tool.</p>
            <p>We write $\lim_{x \to a^-} f(x) = L$ for the <em>left-hand limit</em>. This means $f(x)$ approaches $L$ as $x$ approaches $a$ from the left side (through values of $x$ that are less than $a$).</p>
            <p>We write $\lim_{x \to a^+} f(x) = L$ for the <em>right-hand limit</em>. This means $f(x)$ approaches $L$ as $x$ approaches $a$ from the right side (through values of $x$ that are greater than $a$).</p>
            
            <div class="remark">
                <h4>Existence of a Limit (Theorem)</h4>
                <p>This leads to a crucial condition for the existence of a standard, two-sided limit:</p>
                <p>$$ \lim_{x \to a} f(x) = L \quad \text{if and only if} \quad \lim_{x \to a^-} f(x) = L \quad \text{and} \quad \lim_{x \to a^+} f(x) = L $$</p>
                <p>In other words, for a limit to exist, the function must be approaching the same value from both the left and the right.</p>
            </div>

            <div class="example-box">
                <h3>Example 1</h3>
                <p>Consider the piecewise function $f(x) = \begin{cases} x+2 & \text{if } x < 1 \\ x^2 - 3 & \text{if } x \geq 1 \end{cases}$. Find the left-hand limit, the right-hand limit, and the overall limit as $x \to 1$.</p>
                <h4>Solution:</h4>
                <p>To find the left-hand limit, $\lim_{x \to 1^-} f(x)$, we are interested in values of $x < 1$. For these values, the rule is $f(x) = x+2$.</p>
                <p>$$\lim_{x \to 1^-} f(x) = \lim_{x \to 1^-} (x+2) = 1+2 = 3$$</p>
                <p>To find the right-hand limit, $\lim_{x \to 1^+} f(x)$, we need to use the rule for $x \geq 1$, which is $f(x) = x^2 - 3$.</p>
                <p>$$\lim_{x \to 1^+} f(x) = \lim_{x \to 1^+} (x^2-3) = 1^2 - 3 = -2$$</p>
                <p>Since the left-hand limit (3) is not equal to the right-hand limit (-2), the overall limit does not exist. This is called a <em>jump discontinuity</em>.</p>
                <p>$$\lim_{x \to 1} f(x) \text{ does not exist.}$$</p>
                <iframe src="https://www.desmos.com/calculator/hsasuw6vhy?embed" width="900" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>
            </div>

            <div class="example-box">
                <h3>Example 2</h3>
                <p>Find the one-sided limits of $f(x) = \frac{|x-2|}{x-2}$ as $x \to 2$.</p>
                <h4>Solution:</h4>
                <p>First, let's recall the definition of the absolute value function. We can write it as a piecewise function:</p>
                <p>$$|x-2| = \begin{cases} x-2 & \text{if } x-2 \geq 0 \quad (\text{i.e., } x \geq 2) \\ -(x-2) & \text{if } x-2 < 0 \quad (\text{i.e., } x < 2) \end{cases}$$</p>
                <p>Now we can use this to find the one-sided limits.</p>
                <p>For the left-hand limit ($x \to 2^-$), we have $x < 2$, so we use the rule $|x-2| = -(x-2)$.</p>
                <p>$$\lim_{x \to 2^-} \frac{-(x-2)}{x-2} = \lim_{x \to 2^-} (-1) = -1$$</p>
                <p>For the right-hand limit ($x \to 2^+$), we have $x > 2$, so we use the rule $|x-2| = x-2$.</p>
                <p>$$\lim_{x \to 2^+} \frac{x-2}{x-2} = \lim_{x \to 2^+} (1) = 1$$</p>
                <p>Since $\lim_{x \to 2^-}f(x) = -1$ and $\lim_{x \to 2^+}f(x) = 1$, the overall limit does not exist.</p>
                <iframe src="https://www.desmos.com/calculator/jzhind5vir?embed" width="900" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>
            </div>

            <div class="example-box check-understanding">
                <h4>Check Your Understanding: Pause the playback</h4>
                <p>Problem: Let $f(x) = \begin{cases} \sqrt{9-x^2} & \text{if } -3 \le x < 3 \\ x-3 & \text{if } x \ge 3 \end{cases}$. Find $\lim_{x \to 3^-} f(x)$, $\lim_{x \to 3^+} f(x)$, and $\lim_{x \to 3} f(x)$.</p>
                <div class="solution" style="display: none;">
                    <p>Solution:</p>
                    <p>For the left-hand limit ($x \to 3^-$), we use the first rule, since $x < 3$.</p>
                    <p>$$\lim_{x \to 3^-} f(x) = \lim_{x \to 3^-} \sqrt{9-x^2} = \sqrt{9 - 3^2} = \sqrt{9-9} = 0$$</p>
                    <p>For the right-hand limit ($x \to 3^+$), we use the second rule, since $x > 3$.</p>
                    <p>$$\lim_{x \to 3^+} f(x) = \lim_{x \to 3^+} (x-3) = 3-3 = 0$$</p>
                    <p>Because the left-hand limit (0) is equal to the right-hand limit (0), the overall limit exists and is equal to this value.</p>
                    <p>$$\lim_{x \to 3} f(x) = 0$$</p>
                    <iframe src="https://www.desmos.com/calculator/kkbzsgnx9r?embed" width="900" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>
                </div>
            </div>
            <hr>
            
            <h2>Topic 3: Infinite Limits and Vertical Asymptotes</h2>
            <p>What happens if the values of $f(x)$ grow without bound as $x$ approaches $a$? We call this an <em>infinite limit</em>. This often happens when the denominator of a fraction approaches zero while the numerator approaches a non-zero number.</p>
            <p>We write $\lim_{x \to a} f(x) = \infty$ if the values of $f(x)$ grow arbitrarily large and positive. We write $\lim_{x \to a} f(x) = -\infty$ if the values of $f(x)$ grow arbitrarily large and negative.</p>
            <p>When this occurs, the line $x=a$ is a <em>vertical asymptote</em> of the graph of $f(x)$.</p>
            <p class="remark">When we say a limit equals $\infty$, we are describing "why" the limit does not exist. Remember, $\infty$ is a concept, not a real number.</p>

             <div class="example-box">
                <h3>Example 1</h3>
                <p>Find the limit of $f(x) = \frac{1}{(x-3)^2}$ as $x \to 3$.</p>
                <h4>Solution:</h4>
                <p>As $x$ approaches 3 (from either side), the term $(x-3)$ becomes a number very close to 0. Because this term is squared, $(x-3)^2$ will be a very small "positive" number. Let's confirm this with a table.</p>
                <table>
                    <tr><th>$x$</th><th>$x-3$</th><th>$(x-3)^2$</th><th>$f(x) = \frac{1}{(x-3)^2}$</th></tr>
                    <tr><td>2.9</td><td>-0.1</td><td>0.01</td><td>100</td></tr>
                    <tr><td>2.99</td><td>-0.01</td><td>0.0001</td><td>10,000</td></tr>
                    <tr><td>3.01</td><td>0.01</td><td>0.0001</td><td>10,000</td></tr>
                    <tr><td>3.1</td><td>0.1</td><td>0.01</td><td>100</td></tr>
                </table>
                <p>The table shows that dividing 1 by a very small positive number results in a very large positive number. Therefore:</p>
                <p>$$\lim_{x \to 3} \frac{1}{(x-3)^2} = \infty$$</p>
                <p>The line $x=3$ is a vertical asymptote.</p>
                <iframe src="https://www.desmos.com/calculator/x3pghtigeg?embed" width="900" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>
            </div>

            <div class="example-box">
                <h3>Example 2</h3>
                <p>Find the limit of $f(x) = \frac{x}{(x+2)^2}$ as $x \to -2$.</p>
                <h4>Solution:</h4>
                <p>Let's analyze the numerator and denominator as $x \to -2$. The numerator $x$ approaches -2. The denominator $(x+2)^2$ approaches 0 and will always be positive. Thus, we expect the limit to be $-\infty$. A table of values can confirm our reasoning.</p>
                <table>
                    <tr><th>$x$</th><th>Numerator ($x$)</th><th>Denominator ($(x+2)^2$)</th><th>$f(x) = \frac{x}{(x+2)^2}$</th></tr>
                    <tr><td>-2.1</td><td>-2.1</td><td>0.01</td><td>-210</td></tr>
                    <tr><td>-2.01</td><td>-2.01</td><td>0.0001</td><td>-20,100</td></tr>
                    <tr><td>-1.99</td><td>-1.99</td><td>0.0001</td><td>-19,900</td></tr>
                    <tr><td>-1.9</td><td>-1.9</td><td>0.01</td><td>-190</td></tr>
                </table>
                <p>The values are becoming large and negative. Therefore:</p>
                <p>$$\lim_{x \to -2} \frac{x}{(x+2)^2} = -\infty$$</p>
                <p>The line $x=-2$ is a vertical asymptote for this function.</p>
                <img src="media/limit-inf-neg.png" alt="Graph showing a vertical asymptote at x=-2 with both sides going to negative infinity.">
            </div>

            <div class="example-box check-understanding">
                <h4>Check Your Understanding: Pause the playback</h4>
                <p>Problem: Find the one-sided limits of $f(x) = \frac{x+1}{x-4}$ as $x \to 4$.</p>
                <div class="solution" style="display: none;">
                    <p>Solution:</p>
                    <p><em>Left-hand limit ($x \to 4^-$):</em> We consider $x$ slightly less than 4 (e.g., $x=3.99$).<br>
                    The numerator $x+1$ approaches $4+1=5$.<br>
                    The denominator $x-4$ is a small negative number (e.g., $3.99-4 = -0.01$).<br>
                    Dividing a positive number by a small negative number gives a large negative number.
                    $$\lim_{x \to 4^-} \frac{x+1}{x-4} = -\infty$$</p>
                    <p><em>Right-hand limit ($x \to 4^+$):</em> We consider $x$ slightly greater than 4 (e.g., $x=4.01$).<br>
                    The numerator $x+1$ approaches $5$.<br>
                    The denominator $x-4$ is a small positive number (e.g., $4.01-4 = 0.01$).<br>
                    Dividing a positive number by a small positive number gives a large positive number.
                    $$\lim_{x \to 4^+} \frac{x+1}{x-4} = \infty$$</p>
                    <p>The line $x=4$ is a vertical asymptote. The overall limit does not exist because the one-sided limits differ.</p>
                    <iframe src="https://www.desmos.com/calculator/cbkrobj9tt?embed" width="900" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>
                </div>
            </div>
            <hr>
            <h2>Summary: When Limits Fail to Exist</h2>
            <p>To summarize, a limit $\lim_{x \to a} f(x)$ fails to exist for three main reasons:</p>
            <ol>
                <li><em>Jump Discontinuity:</em> The function approaches different values from the left and the right. $\lim_{x \to a^-}f(x) \neq \lim_{x \to a^+}f(x)$.</li>
                <li><em>Infinite Discontinuity:</em> The function grows without bound towards $\infty$ or $-\infty$. We call this a vertical asymptote.</li>
                <li><em>Oscillating Behavior:</em> The function oscillates so rapidly near the point that it doesn't approach any single value. The classic example is $f(x) = \sin(\frac{1}{x})$ as $x \to 0$.</li>
            </ol>
            <iframe src="https://www.desmos.com/calculator/jar3o8yeha?embed" width="900" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>
            <hr>
            <p>Today we have built a solid intuition for what a limit is, how to investigate it numerically and graphically, and the different ways a limit can exist or fail to exist. In our next lecture, we will move beyond this estimation-based approach and learn the algebraic rules—the Limit Laws—that will allow us to calculate limits precisely and efficiently.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const lectureContent = document.getElementById('lecture-content');
            const pausePlayButton = document.getElementById('pausePlayButton');
            const speedSelect = document.getElementById('speedSelect');
            const showAllButton = document.getElementById('showAllButton');
            const elementsToProcess = Array.from(lectureContent.children);
            
            let currentElementIndex = 0;
            let isPaused = true;
            let timerId = null;

            function getBaseDelay(element) {
                if (!element) return 0;
                const textContent = element.textContent || '';
                const wordCount = textContent.split(/\s+/).filter(word => word.length > 0).length;
                
                if (element.tagName === 'TABLE' || element.tagName === 'IFRAME' || element.tagName === 'IMG') return 4000;
                if (element.tagName === 'HR') return 500;
                
                // Use a standard words-per-minute calculation for paragraphs and headers
                return Math.max(1000, wordCount * 250); 
            }
            
            function playNextElement() {
                if (isPaused) return;

                if (currentElementIndex >= elementsToProcess.length) {
                    pausePlayButton.textContent = 'Restart';
                    isPaused = true;
                    return;
                }

                const element = elementsToProcess[currentElementIndex];
                element.classList.remove('hidden-text');
                
                if (window.MathJax) {
                    MathJax.typesetPromise([element]).then(() => {
                        element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    });
                } else {
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }

                let delay = getBaseDelay(element) / parseFloat(speedSelect.value);

                if (element.classList.contains('check-understanding')) {
                    const solutionDiv = element.querySelector('.solution');
                    
                    timerId = setTimeout(() => {
                        if (isPaused) return;
                        
                        const solutionPauseDelay = 8000 / parseFloat(speedSelect.value);
                        timerId = setTimeout(() => {
                            if (isPaused) return;

                            solutionDiv.style.display = 'block';
                            if (window.MathJax) MathJax.typesetPromise([solutionDiv]);
                            
                            const solutionReadDelay = getBaseDelay(solutionDiv) / parseFloat(speedSelect.value);
                            timerId = setTimeout(() => {
                                currentElementIndex++;
                                playNextElement();
                            }, solutionReadDelay);
                        }, solutionPauseDelay);

                    }, delay);
                } else {
                    // Standard element timing
                    timerId = setTimeout(() => {
                        currentElementIndex++;
                        playNextElement();
                    }, delay);
                }
            }
            
            function togglePausePlay() {
                if (currentElementIndex >= elementsToProcess.length && isPaused) {
                    resetLecture();
                }
                
                isPaused = !isPaused;
                pausePlayButton.textContent = isPaused ? 'Play' : 'Pause';

                if (isPaused) {
                    clearTimeout(timerId);
                } else {
                    playNextElement();
                }
            }

            function changePlaybackSpeed() {
                if (!isPaused) {
                    clearTimeout(timerId);
                    playNextElement();
                }
            }

            function showAllContent() {
                clearTimeout(timerId);
                elementsToProcess.forEach(el => {
                    el.classList.remove('hidden-text');
                    const solutionDiv = el.querySelector('.solution');
                    if(solutionDiv) solutionDiv.style.display = 'block';
                });
                if (window.MathJax) {
                    MathJax.typesetPromise([lectureContent]);
                }
                currentElementIndex = elementsToProcess.length;
                isPaused = true;
                pausePlayButton.textContent = 'Restart';
            }

            function resetLecture() {
                clearTimeout(timerId);
                elementsToProcess.forEach(el => {
                    el.classList.add('hidden-text');
                    const solutionDiv = el.querySelector('.solution');
                    if(solutionDiv) solutionDiv.style.display = 'none';
                });
                currentElementIndex = 0;
                isPaused = true;
                pausePlayButton.textContent = 'Play';
            }
            
            pausePlayButton.addEventListener('click', togglePausePlay);
            speedSelect.addEventListener('change', changePlaybackSpeed);
            showAllButton.addEventListener('click', showAllContent);
            
            resetLecture(); 
        });
    </script>
</body>
</html>
